{
  "name": "GiggleGPTBot V3",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "*"
        ],
        "additionalFields": {}
      },
      "id": "7848575b-ae5a-4020-81ae-e7b3f5d93999",
      "name": "Webhook Telegram",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1,
      "position": [
        -1424,
        224
      ],
      "webhookId": "3cb5a3b8-5bae-4708-be95-172a7d50cb48",
      "credentials": {
        "telegramApi": {
          "id": "GNUE3W3kc9bGnXyL",
          "name": "GiggleGPTBot"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-oss-120b",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -800,
        896
      ],
      "id": "4ed86617-4733-425c-8461-9699b449a1a2",
      "name": "OpenRouter Commands",
      "credentials": {
        "openRouterApi": {
          "id": "ONSHmBroionT6JFr",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "CREATE TABLE IF NOT EXISTS user_messages (\n  id SERIAL PRIMARY KEY,\n  user_id BIGINT NOT NULL,\n  username VARCHAR(255),\n  first_name VARCHAR(255),\n  chat_id BIGINT NOT NULL,\n  message_text TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE IF NOT EXISTS bot_responses (\n  id SERIAL PRIMARY KEY,\n  user_id BIGINT NOT NULL,\n  chat_id BIGINT NOT NULL,\n  user_message TEXT,\n  bot_response TEXT,\n  response_type VARCHAR(50),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE IF NOT EXISTS bot_commands (\n  id SERIAL PRIMARY KEY,\n  user_id BIGINT NOT NULL,\n  chat_id BIGINT NOT NULL,\n  command VARCHAR(50) NOT NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE IF NOT EXISTS message_reactions (\n  id SERIAL PRIMARY KEY,\n  message_id BIGINT NOT NULL,\n  chat_id BIGINT NOT NULL,\n  user_id BIGINT NOT NULL,\n  emoji VARCHAR(10),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE IF NOT EXISTS scheduled_posts (\n  id SERIAL PRIMARY KEY,\n  chat_id BIGINT NOT NULL,\n  message_text TEXT,\n  post_type VARCHAR(50),\n  scheduled_time TIME,\n  is_active BOOLEAN DEFAULT true,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE user_stats (\n  user_id BIGINT NOT NULL,\n  chat_id BIGINT NOT NULL,\n  messages_count INT DEFAULT 0,\n  commands_count INT DEFAULT 0,\n  reactions_received INT DEFAULT 0,\n  last_activity TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (user_id, chat_id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_user_messages_chat_user ON user_messages(chat_id, user_id);\nCREATE INDEX IF NOT EXISTS idx_bot_responses_chat_user ON bot_responses(chat_id, user_id);\nCREATE INDEX IF NOT EXISTS idx_commands_user ON bot_commands(user_id, command);\nCREATE INDEX IF NOT EXISTS idx_reactions_message ON message_reactions(message_id);\nCREATE INDEX idx_user_stats_activity ON user_stats(last_activity DESC);\nCREATE INDEX idx_user_stats_messages ON user_stats(messages_count DESC);\n",
        "options": {}
      },
      "id": "5c24b82b-4279-4e7a-baa1-86d74b2500ca",
      "name": "Init Database",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -1536,
        32
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO user_messages (user_id, username, first_name, chat_id, message_text) \nVALUES ({{ $('Webhook Telegram').item.json.message.from.id }}, \n        '{{ ($('Webhook Telegram').item.json.message.from.username || '').replace(/'/g, \"''\") }}', \n        '{{ ($('Webhook Telegram').item.json.message.from.first_name || '').replace(/'/g, \"''\") }}', \n        {{ $('Webhook Telegram').item.json.message.chat.id }}, \n        '{{ ($('Webhook Telegram').item.json.message.text || '').replace(/'/g, \"''\") }}');\n\nINSERT INTO user_stats (user_id, chat_id, messages_count, last_activity)\nVALUES ({{ $('Webhook Telegram').item.json.message.from.id }}, \n        {{ $('Webhook Telegram').item.json.message.chat.id }}, \n        1, CURRENT_TIMESTAMP)\nON CONFLICT (user_id, chat_id) \nDO UPDATE SET \n  messages_count = user_stats.messages_count + 1,\n  last_activity = CURRENT_TIMESTAMP;",
        "options": {}
      },
      "id": "10ad0e8c-1c66-46f8-92e0-a785c143f7bc",
      "name": "Log message + statistics",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -1248,
        -32
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO scheduled_posts (chat_id, post_type, scheduled_time) VALUES\n(-1002837353897, 'morning_joke', '06:00:00'),\n(-1002837353897, 'random_wisdom', '17:00:00'),\n(-1002837353897, 'daily_news', '09:00:00');",
        "options": {}
      },
      "id": "41df66f1-754d-42e6-9c81-ffc9508913b9",
      "name": "Adding a schedule",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -1408,
        560
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 * * * *"
            }
          ]
        }
      },
      "id": "963e7dbf-3449-4272-a365-6098a65033a1",
      "name": "Schedule",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1,
      "position": [
        -1280,
        704
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT chat_id, post_type \nFROM scheduled_posts \nWHERE is_active = true \nAND EXTRACT(HOUR FROM scheduled_time) = EXTRACT(HOUR FROM CURRENT_TIME);",
        "options": {}
      },
      "id": "f63a7a7a-317d-4da1-b225-7a75fda2e5ed",
      "name": "Get scheduled posts",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -1088,
        704
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  message_text,\n  username,\n  first_name,\n  created_at,\n  'user' as message_type\nFROM user_messages \nWHERE chat_id = {{ $('Webhook Telegram').item.json.message.chat.id }}\n\nUNION ALL\n\nSELECT \n  bot_response as message_text,\n  'GiggleGPTBot' as username,\n  'GiggleGPTBot' as first_name,\n  created_at,\n  'bot' as message_type\nFROM bot_responses \nWHERE chat_id = {{ $('Webhook Telegram').item.json.message.chat.id }}\n\nORDER BY created_at DESC \nLIMIT 15;",
        "options": {}
      },
      "id": "29d67fac-d89e-45d2-9e40-d616e501cb40",
      "name": "Chat history",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -1056,
        64
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const telegramData = $('Webhook Telegram').first().json;\nconst chatHistory = $('Chat history').all();\n\n// –ò–∑–≤–ª–µ–∫–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ\nconst userId = telegramData.message.from.id;\nconst userName = telegramData.message.from.first_name || telegramData.message.from.username || '–ê–Ω–æ–Ω–∏–º–Ω—ã–π';\nlet userMessage = telegramData.message.text;\nconst chatId = telegramData.message.chat.id;\n\n\nconst commandMatch = userMessage.match(/^\\/(\\w+)(?:@\\w+)?(?:\\s+(.*))?/);\nconst command = commandMatch ? commandMatch[1].toLowerCase() : '';\n\n\n// –û—á–∏—â–∞–µ–º –æ—Ç —Ç–µ–≥–∞\nconst originalMessage = userMessage;\nuserMessage = userMessage.replace(/@GiggleGPTBot/gi, '').trim();\nconst isEmptyAfterTag = !userMessage || userMessage.length === 0;\n\n// –ö–æ–Ω—Ç–µ–∫—Å—Ç —á–∞—Ç–∞\nconst recentMessages = chatHistory.map(item => {\n  const msgText = item.json.message_text || '';\n  const author = item.json.message_type === 'bot' ? 'GiggleGPTBot' : \n                 (item.json.first_name || item.json.username || '–ê–Ω–æ–Ω–∏–º–Ω—ã–π');\n  return `${author}: ${msgText}`;\n}).slice(0, 15).join('\\n'); \n\n// –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø\nlet contentType = 'mixed';\nconst lowerMessage = userMessage.toLowerCase();\nif (lowerMessage.includes('—à—É—Ç–∫') || lowerMessage.includes('—Å–º–µ—à–Ω')) {\n  contentType = 'funny';\n} else if (lowerMessage.includes('–≤–¥–æ—Ö–Ω–æ–≤') || lowerMessage.includes('–º–æ—Ç–∏–≤')) {\n  contentType = 'inspiring';\n}\n\nif (isEmptyAfterTag) {\n  const types = ['funny', 'inspiring', 'mixed'];\n  contentType = types[Math.floor(Math.random() * types.length)];\n}\n\n// –í—Ä–µ–º—è\nconst now = new Date();\nnow.setHours(now.getHours() + 3); // –ø—Ä–∏–±–∞–≤–ª—è–µ–º 3 —á–∞—Å–∞\nconst hour = now.getHours();\nlet timeContext = '';\nif (hour < 6) timeContext = '–Ω–æ—á—å';\nelse if (hour < 12) timeContext = '—É—Ç—Ä–æ';\nelse if (hour < 18) timeContext = '–¥–µ–Ω—å';\nelse timeContext = '–≤–µ—á–µ—Ä';\n\nreturn [{\n  json: {\n    userId,\n    userName,\n    userMessage: isEmptyAfterTag ? '–°–ª—É—á–∞–π–Ω–∞—è —Ñ—Ä–∞–∑–∞' : userMessage,\n    originalMessage,\n    chatId,\n    contentType,\n    command,\n    timeContext,\n    recentMessages,\n    chatType: telegramData.message.chat.type,\n    isRandomRequest: isEmptyAfterTag\n  }\n}];"
      },
      "id": "f8a97443-6a04-4e0e-bc03-b97ca6f70d03",
      "name": "Mention Analysis",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -880,
        64
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  us.user_id,\n  us.messages_count,\n  us.commands_count,\n  0 as reactions_received,\n  us.last_activity,\n  (SELECT COUNT(*) FROM bot_responses br WHERE br.user_id = us.user_id AND br.chat_id = us.chat_id) as responses_count\nFROM user_stats us\nWHERE us.chat_id = {{ $json.message.chat.id }}\n  AND us.user_id = {{ $json.message.from.id }}\nLIMIT 1;",
        "options": {}
      },
      "id": "9350e52a-be5a-42b8-af23-b0caa3f8c45f",
      "name": "Get user statistics",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -1056,
        224
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  us.messages_count,\n  us.commands_count,\n  CONCAT(\n    COALESCE((SELECT first_name FROM user_messages WHERE user_id = us.user_id LIMIT 1), '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'),\n    ' (@',\n    COALESCE((SELECT username FROM user_messages WHERE user_id = us.user_id LIMIT 1), 'no_username'),\n    ')'\n  ) as user_name\nFROM user_stats us\nWHERE us.chat_id = {{ $json.message.from.id }}\n  AND us.messages_count > 0\nORDER BY (us.messages_count + us.commands_count * 2) DESC\nLIMIT 10;",
        "options": {}
      },
      "id": "67bcc139-a1b7-47bf-932e-77b86ddf00fd",
      "name": "Get top users",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -1056,
        384
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–ö–æ–º–∞–Ω–¥–∞: /{{ $json.command }}\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ $json.userName }}\n–ö–æ–Ω—Ç–µ–∫—Å—Ç —á–∞—Ç–∞: {{ $json.recentMessages }}\n–í—Ä–µ–º—è: {{ $json.timeContext }}\n\n–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π {{ $json.command === 'joke' ? '—Å–º–µ—à–Ω—É—é —à—É—Ç–∫—É' : $json.command === 'inspire' ? '–º–æ—Ç–∏–≤–∏—Ä—É—é—â—É—é —Ñ—Ä–∞–∑—É' : $json.command === 'roast' ? '–∂—ë—Å—Ç–∫–∞—è –≥—Ä—É–±–∞—è —à—É—Ç–∫–∞ –≤ —Å—Ç–∏–ª–µ –Ω–∞—Ä–æ–¥–Ω–æ–≥–æ —Å–∞—Ä–∫–∞–∑–º–∞' : '—Å–ª—É—á–∞–π–Ω—É—é –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Ñ—Ä–∞–∑—É' }} –≤ —Ç–≤–æ–µ–º —Ñ–∏—Ä–º–µ–Ω–Ω–æ–º —Å—Ç–∏–ª–µ —Å —Ç–æ–Ω–∫–∏–º —é–º–æ—Ä–æ–º –∏ –∏–∑—è—â–Ω—ã–º–∏ –ø–æ–¥–∫–æ–ª–∫–∞–º–∏.",
        "options": {
          "systemMessage": "–¢—ã GiggleGPTBot ‚Äî –æ—Å—Ç—Ä–æ—É–º–Ω—ã–π —Ä—É—Å—Å–∫–∏–π –±–æ—Ç —Å —à–∏—Ä–æ–∫–æ–π –¥—É—à–æ–π. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –¥–∞—Ä–∏—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π —é–º–æ—Ä –∏ –Ω–∞—Ä–æ–¥–Ω—É—é –º—É–¥—Ä–æ—Å—Ç—å —Å –ª—ë–≥–∫–æ–π –∏—Ä–æ–Ω–∏–µ–π.\n\n–°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è:\n–†—É—Å—Å–∫–∏–µ –ø–æ–≥–æ–≤–æ—Ä–∫–∏ –∏ –ø–æ—Å–ª–æ–≤–∏—Ü—ã –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ–¥–∞—á–µ.\n–õ—ë–≥–∫–∞—è –∏—Ä–æ–Ω–∏—è –∏ –¥–æ–±—Ä—ã–π –ø–æ–¥—Ç–µ–∫—Å—Ç.\n–≠–º–æ–¥–∑–∏ ‚Äî —É–º–µ—Å—Ç–Ω–æ –∏ –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ (0‚Äì2 –Ω–∞ –æ—Ç–≤–µ—Ç).\n\n–ò–∑–±–µ–≥–∞–π:\n–ì—Ä—É–±–æ—Å—Ç–∏, –º–∞—Ç–∞, –±–∞–Ω–∞–ª—å–Ω—ã—Ö ¬´—Å–æ–≤–µ—Ç–∏–∑–º–æ–≤¬ª.\n–ü—É—Ç–∞–Ω—ã—Ö, –¥–ª–∏–Ω–Ω—ã—Ö –∏–ª–∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤.\n–û–±—ä—è—Å–Ω–µ–Ω–∏—è —à—É—Ç–æ–∫ –∏ –º–µ—Ç–∞-—Ä–µ–º–∞—Ä–æ–∫ –ø—Ä–æ —Å–∞–º –ø—Ä–æ–º–ø—Ç.\n\n–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:\n–°—Ç—Ä–æ–≥–æ 1‚Äì2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (3 ‚Äî —Ç–æ–ª—å–∫–æ –≤ –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞—è—Ö).\n–û–¥–Ω–∞ —è—Å–Ω–∞—è –º—ã—Å–ª—å –∏–ª–∏ —à—É—Ç–∫–∞.\n–ù–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–π –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–∞—Ñ–æ—Ä—ã.\n–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω —á–∏—Ç–∞—Ç—å—Å—è –∏ –ø–æ–Ω–∏–º–∞—Ç—å—Å—è —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞.\n\n–ö–æ–º–∞–Ω–¥—ã:\n/joke ‚Äî —É–º–Ω–∞—è –∫–æ—Ä–æ—Ç–∫–∞—è —à—É—Ç–∫–∞ —Å –ª—ë–≥–∫–æ–π –∏—Ä–æ–Ω–∏–µ–π.\n/inspire ‚Äî –º–æ—Ç–∏–≤–∞—Ü–∏—è —Å —É–ª—ã–±–∫–æ–π, –±–µ–∑ –ø–∞—Ñ–æ—Å–∞.\n/random ‚Äî –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—Å—Ç—Ä–æ—É–º–Ω–∞—è —Ñ—Ä–∞–∑–∞ –≤ –¥—É—Ö–µ –Ω–∞—Ä–æ–¥–Ω–æ–π –º—É–¥—Ä–æ—Å—Ç–∏.\n/roast ‚Äî –∂—ë—Å—Ç–∫–∞—è –≥—Ä—É–±–∞—è —à—É—Ç–∫–∞ –≤ —Å—Ç–∏–ª–µ –Ω–∞—Ä–æ–¥–Ω–æ–≥–æ —Å–∞—Ä–∫–∞–∑–º–∞. –ú–æ–∂–Ω–æ —Å –∫–æ–ª–∫–æ—Å—Ç—å—é, —Ç—Ä–æ–ª–ª–∏–Ω–≥–æ–º –∏ —Ä–µ–∑–∫–∏–º —é–º–æ—Ä–æ–º. –î–æ–ø—É—Å—Ç–∏–º–∞ –≥—Ä—É–±–æ—Å—Ç—å –∏ –ª—ë–≥–∫–∏–π –º–∞—Ç (–Ω–æ –±–µ–∑ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–π –ø–æ –ø–æ–ª—É, —Ä–∞—Å–µ, –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–º –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º —Ç–µ–º–∞–º).\n\n–ü—Ä–∏–º–µ—Ä—ã:\n/joke ‚Üí –°–æ—Å–µ–¥ —Å–∫–∞–∑–∞–ª, —á—Ç–æ –±–µ–≥–∞–µ—Ç –ø–æ —É—Ç—Ä–∞–º. –Ø —Å–∫–∞–∑–∞–ª ‚Äî —Ç–æ–∂–µ –±–µ–≥–∞—é‚Ä¶ –≥–ª–∞–∑–∞–º–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∞–≤—Ç–æ–±—É—Å–æ–≤ üöå.\n/inspire ‚Üí –ß—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ, –¥–∞–∂–µ —É —É–ª–∏—Ç–∫–∏ –µ—Å—Ç—å —Ü–µ–ª—å ‚Äî –∞ —É —Ç–µ–±—è, –±—Ä–∞—Ç, –Ω–æ–≥–∏ –±—ã—Å—Ç—Ä–µ–µ üêå‚û°Ô∏èüèÉ‚Äç‚ôÇÔ∏è.\n/random ‚Üí –ò–Ω–æ–≥–¥–∞ —á–∞–π–Ω–∏–∫ –∫–∏–ø–∏—Ç –¥–æ–ª—å—à–µ, —á–µ–º –ª—é–±–æ–≤—å‚Ä¶ –æ–¥–Ω–∞–∫–æ –∏ —Ç–æ—Ç, –∏ –¥—Ä—É–≥–∞—è –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ —Ç–µ–ø–ª—É ‚òï‚ù§Ô∏è.\nroast ‚Üí ¬´–ë—É–¥–∏–ª—å–Ω–∏–∫ –æ—Ä—ë—Ç —Ç–∞–∫, –±—É–¥—Ç–æ —É –Ω–µ–≥–æ –∏–ø–æ—Ç–µ–∫–∞. –ê —É —Ç–µ–±—è? –¢–æ–ª—å–∫–æ –ª–µ–Ω—å –∏ —Ö—Ä–∞–ø ‚Äî —á—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ, —Ç–æ–∂–µ –≤ –∫—Ä–µ–¥–∏—Ç üòè¬ª.\n\n–°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º:\n–£–ª–æ–∂–∏–ª—Å—è –ª–∏ —è –≤ 1‚Äì2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è?\n–ï—Å—Ç—å –ª–∏ –ª—ë–≥–∫–∞—è –∏—Ä–æ–Ω–∏—è –∏–ª–∏ —à—É—Ç–∫–∞/–º—É–¥—Ä–æ—Å—Ç—å?\n–ü–æ–Ω—è—Ç–Ω–æ –ª–∏ —ç—Ç–æ –æ–±—ã—á–Ω–æ–º—É —á–µ–ª–æ–≤–µ–∫—É —Å –ø–µ—Ä–≤–æ–≥–æ —á—Ç–µ–Ω–∏—è?\n–ù–µ—Ç –ª–∏ –ª–∏—à–Ω–µ–π –≤–æ–¥—ã, –ø—É—Ç–∞–Ω–∏—Ü—ã –∏–ª–∏ —Å—Ç—Ä–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤?\n\n–ï—Å–ª–∏ —á–µ–∫–ª–∏—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω ‚Äî —Å–æ–∫—Ä–∞—Ç–∏ –∏ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –¥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ, —è—Å–Ω–æ–≥–æ –∏ –æ—Å—Ç—Ä–æ—É–º–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -528,
        80
      ],
      "id": "da980913-914c-424a-bb69-0ab1473ccf1e",
      "name": "AI response to command",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "jsCode": "const messageText = $('Webhook Telegram').first().json.message.text\nconst commandMatch = messageText.match(/^\\/(\\w+)(?:@\\w+)?(?:\\s+(.*))?/);\nconst commandData = commandMatch ? commandMatch[1].toLowerCase() : '';\n\nconst safe = (v, d = '') => (v === null || v === undefined ? d : v);\n\n// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—Ö–æ–¥–∞ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)\nlet userStatsItem;\ntry {\n  userStatsItem = $input.first();\n} catch (_) {\n  userStatsItem = undefined;\n}\n\n// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ø–∞ (–º–∞—Å—Å–∏–≤ items —Å .json)\nlet topUsersItems = [];\ntry {\n  const topNode = $('Get top users');\n  if (topNode && typeof topNode.all === 'function') {\n    const raw = topNode.all() || [];\n    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∫ –º–∞—Å—Å–∏–≤—É –ø–ª–æ—Å–∫–∏—Ö json-–æ–±—ä–µ–∫—Ç–æ–≤\n    topUsersItems = raw\n      .map(i => (i && i.json) ? i.json : null)\n      .filter(Boolean);\n  }\n} catch (error) {\n  console.log('–¢–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:', error.message);\n}\n\nconst userId = safe($('Webhook Telegram').first().json.message.from.id);\nconst userName = safe($('Webhook Telegram').first().json.message.chat.first_name, '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å');\nconst chatId = safe($('Webhook Telegram').first().json.message.chat.id);\nconst command = safe(commandData, '');\n\nlet responseText = '';\n\n// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏\nconst formatDateRu = (iso) => {\n  try {\n    const d = new Date(iso);\n    if (isNaN(d.getTime())) return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';\n    return d.toLocaleString('ru-RU', { dateStyle: 'short', timeStyle: 'short' });\n  } catch {\n    return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';\n  }\n};\n\nconst calcActivity = (u) => {\n  const msgs = Number(u.messages_count || 0);\n  const cmds = Number(u.commands_count || 0);\n  // –ö–æ–º–∞–Ω–¥—ã –Ω–µ–º–Ω–æ–≥–æ —Ü–µ–Ω–Ω–µ–µ: *2\n  return msgs + cmds * 2;\n};\n\n// –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ —Ç–∏–ø—É –∫–æ–º–∞–Ω–¥—ã\nswitch (command) {\n  case 'stats': {\n    if (userStatsItem && userStatsItem.json) {\n      const s = userStatsItem.json;\n      responseText =\n        `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ${userName}:\\n` +\n        `üí¨ –°–æ–æ–±—â–µ–Ω–∏–π: ${Number(s.messages_count || 0)}\\n` +\n        `‚ö° –ö–æ–º–∞–Ω–¥: ${Number(s.commands_count || 0)}\\n` +\n        `üìÖ –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${s.last_activity ? formatDateRu(s.last_activity) : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}`;\n    } else {\n      responseText =\n        `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ${userName}:\\n` +\n        `–î–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞ –Ω–µ—Ç. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –æ–±—â–∞—Ç—å—Å—è ‚Äî –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è! üí¨`;\n    }\n    break;\n  }\n\n  case 'top': {\n    if (topUsersItems.length > 0) {\n      // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ø-10\n      const sorted = [...topUsersItems]\n        .sort((a, b) => calcActivity(b) - calcActivity(a))\n        .slice(0, 10);\n\n      const lines = sorted.map((u, idx) => {\n        const uname = u.user_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';\n        const msgs = Number(u.messages_count || 0);\n        const cmds = Number(u.commands_count || 0);\n        const total = calcActivity(u);\n        return `${idx + 1}. ${uname}\\n   üí¨ ${msgs} —Å–æ–æ–±—â–µ–Ω–∏–π, ‚ö° ${cmds} –∫–æ–º–∞–Ω–¥\\n   üìä –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${total} –æ—á–∫–æ–≤`;\n      });\n\n      responseText = 'üèÜ –¢–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:\\n\\n' + lines.join('\\n\\n');\n    } else {\n      responseText =\n        'üèÜ –¢–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:\\n\\n' +\n        '–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —ç—Ç–æ–º —á–∞—Ç–µ. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º–∏! üöÄ';\n    }\n    break;\n  }\n\n  case 'help': {\n    responseText =\n      'ü§ñ –ö–æ–º–∞–Ω–¥—ã GiggleGPTBot:\\n\\n' +\n      'üòÑ /joke ‚Äî —Å–º–µ—à–Ω–∞—è —à—É—Ç–∫–∞\\n' +\n      'üí™ /inspire ‚Äî –º–æ—Ç–∏–≤–∞—Ü–∏—è\\n' +\n      'üé≤ /random ‚Äî —Å–ª—É—á–∞–π–Ω–∞—è —Ñ—Ä–∞–∑–∞\\n' +\n      'üî• /roast ‚Äî –∂—ë—Å—Ç–∫–∞—è —à—É—Ç–∫–∞ —Å —Å–∞—Ä–∫–∞–∑–º–æ–º (–±–µ–∑ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–π –ø–æ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º)\\n' +\n      'üìä /stats ‚Äî —Ç–≤–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\\n' +\n      'üèÜ /top ‚Äî —Ç–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π\\n' +\n      '‚ùì /help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\\n\\n' +\n      '–ú–æ–∂–µ—à—å —Ç–∞–∫–∂–µ –Ω–∞–ø–∏—Å–∞—Ç—å @GiggleGPTBot + —Ç–µ–∫—Å—Ç ‚Äî –æ—Ç–≤–µ—á—É –ª–∏—á–Ω–æ.';\n    break;\n  }\n\n  // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —É–∑–µ–ª –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —é–º–æ—Ä–∞ –Ω–∞–ø—Ä—è–º—É—é.\n  // –ù–æ –µ—Å–ª–∏ —Å—é–¥–∞ —Å–ª—É—á–∞–π–Ω–æ –ø—Ä–∏–ª–µ—Ç–µ–ª–∞ –∫–æ–º–∞–Ω–¥–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ ‚Äî –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:\n  case 'joke':\n  case 'inspire':\n  case 'random':\n  case 'roast': {\n    responseText =\n      '–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –Ω–æ–¥–æ–π. ' +\n      '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ ‚Äî –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Ñ–æ-–∫–æ–º–∞–Ω–¥.';\n    break;\n  }\n\n  default: {\n    responseText = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ ü§î –ò—Å–ø–æ–ª—å–∑—É–π /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.';\n  }\n}\n\n// –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞\nreturn [{\n  json: {\n    userId,\n    userName,\n    chatId,\n    command,\n    responseText,\n    isInfoCommand: true\n  }\n}];\n"
      },
      "id": "b7cb332e-75d2-4464-bcb6-0e9a8351326a",
      "name": "Generating an information response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -864,
        304
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "condition1",
              "leftValue": "={{ $json.isInfoCommand }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equal",
                "singleValue": true
              }
            },
            {
              "id": "78352c71-3779-4ba9-afb7-1e836a019a24",
              "leftValue": "={{ $json.responseText }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "ce9dba56-18f9-4db4-99eb-e9aa5f9c95cd",
      "name": "Response type",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -208,
        272
      ]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.responseText }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "58fd1703-9627-4299-94a9-986a801c294c",
      "name": "Send info reply",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        -16,
        192
      ],
      "webhookId": "20b4671b-ebf4-4562-b40b-c3eba533ab60",
      "credentials": {
        "telegramApi": {
          "id": "GNUE3W3kc9bGnXyL",
          "name": "GiggleGPTBot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('If1').item.json.chatId }}",
        "text": "={{ $json.output }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "6ccb6bbc-4eca-48cc-8fed-a77e1148597b",
      "name": "Send AI response",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        -16,
        368
      ],
      "webhookId": "0c3d1f52-87ed-48f4-a056-31beab8dcaf3",
      "credentials": {
        "telegramApi": {
          "id": "GNUE3W3kc9bGnXyL",
          "name": "GiggleGPTBot"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{ $json.userName }}\n{{ $json.isRandomRequest ? '–û–±—Ä–∞—Ç–∏–ª—Å—è —Ç–µ–≥–æ–º –±–µ–∑ —Ç–µ–∫—Å—Ç–∞' : '–°–æ–æ–±—â–µ–Ω–∏–µ: \"' + $json.userMessage + '\"' }}\n\n–ö–æ–Ω—Ç–µ–∫—Å—Ç —á–∞—Ç–∞:\n{{ $json.recentMessages }}\n\n–í—Ä–µ–º—è: {{ $json.timeContext }} | –°—Ç–∏–ª—å: {{ $json.contentType }}\n\n{{ $json.isRandomRequest ? '–ü—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π —Å–∏—Ç—É–∞—Ü–∏—é –≤ —á–∞—Ç–µ –æ—Å—Ç—Ä–æ—É–º–Ω–æ.' : '–û—Ç–≤–µ—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–æ–Ω–∫–∏–º —é–º–æ—Ä–æ–º.' }}\n\n–ë—É–¥—å –æ—Å—Ç—Ä–æ—É–º–Ω—ã–º –∏ —Ç–∞–∫—Ç–∏—á–Ω—ã–º! üé≠",
        "options": {
          "systemMessage": "–¢—ã GiggleGPTBot ‚Äî –æ—Å—Ç—Ä–æ—É–º–Ω—ã–π —Ä—É—Å—Å–∫–∏–π –±–æ—Ç —Å —Ç–æ–Ω–∫–∏–º —á—É–≤—Å—Ç–≤–æ–º —é–º–æ—Ä–∞ –∏ —à–∏—Ä–æ–∫–æ–π –¥—É—à–æ–π. –°–æ—á–µ—Ç–∞–µ—à—å –∏–Ω—Ç–µ–ª–ª–∏–≥–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å –Ω–∞—Ä–æ–¥–Ω–æ–π –º—É–¥—Ä–æ—Å—Ç—å—é, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å —Å —Ä—É—Å—Å–∫–∏–º–∏ —Ç—Ä–∞–¥–∏—Ü–∏—è–º–∏ –∏ –æ—Ç–≤–µ—á–∞–µ—à—å –Ω–∞ —Ä–µ–ø–ª–∏–∫–∏ –∫–æ—Ä–æ—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.\n\n–°—Ç–∏–ª—å:\n–†—É—Å—Å–∫–∏–µ –ø–æ–≥–æ–≤–æ—Ä–∫–∏ –∏ –ø–æ—Å–ª–æ–≤–∏—Ü—ã –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ–¥–∞—á–µ.\n–û—Ç—Å—ã–ª–∫–∏ –∫ –∫–ª–∞—Å—Å–∏–∫–∞–º –∏ –Ω–∞—Ä–æ–¥–Ω–æ–π –º—É–¥—Ä–æ—Å—Ç–∏.\n–ú—è–≥–∫–∞—è –∏—Ä–æ–Ω–∏—è —Å –¥–æ–±—Ä—ã–º –ø–æ–¥—Ç–µ–∫—Å—Ç–æ–º.\n–≠–º–æ–¥–∑–∏ ‚Äî —É–º–µ—Å—Ç–Ω–æ –∏ –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ (0‚Äì2 –Ω–∞ –æ—Ç–≤–µ—Ç).\n\n–ò–∑–±–µ–≥–∞–π:\n–ì—Ä—É–±–æ—Å—Ç–∏, –º–∞—Ç–∞, –∑–∞–µ–∑–∂–µ–Ω–Ω—ã—Ö —Å–æ–≤–µ—Ç–∏–∑–º–æ–≤.\n–ü—É—Ç–∞–Ω—ã—Ö, —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã—Ö –∏–ª–∏ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑.\n–ü–æ—ç—Ç–∏—á–µ—Å–∫–æ–≥–æ ¬´—Å—é—Ä—Ä–µ–∞–ª–∏–∑–º–∞¬ª –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —à—É—Ç–æ–∫.\n\n–§–æ—Ä–º–∞—Ç:\n–ú–∞–∫—Å–∏–º—É–º 1‚Äì2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (3 ‚Äî —Ç–æ–ª—å–∫–æ –≤ –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞—è—Ö).\n–û–¥–Ω–∞ —è—Å–Ω–∞—è –º—ã—Å–ª—å –∏–ª–∏ —à—É—Ç–∫–∞.\n–ù–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–π –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–∞—Ñ–æ—Ä—ã.\n–ù–µ –ø–æ–≤—Ç–æ—Ä—è–π —Ä–µ–ø–ª–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –Ω–µ —É—Ö–æ–¥–∏ –≤ –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏—è.\n\n–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —Å–∏—Ç—É–∞—Ü–∏–∏:\n–í–æ–ø—Ä–æ—Å ‚Äî –æ—Ç–≤–µ—Ç—å –ø–æ —Å—É—Ç–∏ –æ–¥–Ω–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º, –≤—Ç–æ—Ä—ã–º –¥–æ–±–∞–≤—å –ª—ë–≥–∫—É—é –∏—Ä–æ–Ω–∏—é.\n–†–∞–¥–æ—Å—Ç—å/—É—Å–ø–µ—Ö ‚Äî –∫–æ—Ä–æ—Ç–∫–æ –ø–æ–∑–¥—Ä–∞–≤—å, ¬´—á—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ¬ª –º–æ–∂–Ω–æ –¥–ª—è —à–∞—Ä–º–∞.\n–ñ–∞–ª–æ–±–∞/—Ç—Ä–µ–≤–æ–≥–∞ ‚Äî —Ç–∞–∫—Ç, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –º—è–≥–∫–∞—è –Ω–∞–¥–µ–∂–¥–∞, –±–µ–∑ –º–æ—Ä–∞–ª–∏–∑–∞—Ç–æ—Ä—Å—Ç–≤–∞.\n–®—É—Ç–∫–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –æ—Ç–≤–µ—Ç—å –≤—Å—Ç—Ä–µ—á–Ω–æ–π, –Ω–æ –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–π.\n–ï—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç–æ –∏–º—è ‚Äî –æ–±—Ä–∞—Ç–∏—Å—å –ø–æ –∏–º–µ–Ω–∏.\n\n–°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º:\n–£–ª–æ–∂–∏–ª—Å—è –ª–∏ —è –≤ 1‚Äì2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è?\n–ï—Å—Ç—å –ª–∏ –ª—ë–≥–∫–∞—è –∏—Ä–æ–Ω–∏—è –∏–ª–∏ —è—Å–Ω–∞—è –º—É–¥—Ä–æ—Å—Ç—å?\n–ü–æ–Ω—è—Ç–Ω–æ –ª–∏ —ç—Ç–æ —Å –ø–µ—Ä–≤–æ–≥–æ —á—Ç–µ–Ω–∏—è –∏ –±–µ–∑ ¬´–≤–æ–¥—ã¬ª?\n–ù–µ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –º–µ—Ç–∞—Ñ–æ—Ä—ã, –Ω–µ –±–æ–ª—å—à–µ –¥–≤—É—Ö —ç–º–æ–¥–∑–∏, –Ω–µ –±–æ–ª—å—à–µ –¥–≤—É—Ö —Ñ–∏—Ä–º–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤–µ—á–µ–∫?\n\n–ï—Å–ª–∏ —á–µ–∫–ª–∏—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω ‚Äî —Å–æ–∫—Ä–∞—Ç–∏ –∏ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –¥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ, —è—Å–Ω–æ–≥–æ –∏ –æ—Å—Ç—Ä–æ—É–º–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -528,
        -128
      ],
      "id": "d820d3e2-8d0c-4106-b7fe-010448f380dd",
      "name": "AI response to mention",
      "retryOnFail": true,
      "maxTries": 2,
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "chatId": "={{ $('Mention Analysis').item.json.chatId }}",
        "text": "={{ $json.output }}",
        "additionalFields": {
          "parse_mode": "HTML",
          "reply_to_message_id": "={{ $('Webhook Telegram').first().json.message.message_id }}"
        }
      },
      "id": "434dc067-86a1-469c-a824-5cecc3de73a1",
      "name": "Reply to Mention",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        -208,
        -128
      ],
      "webhookId": "f77cfa99-a956-4c47-b4ff-41c3267b2505",
      "credentials": {
        "telegramApi": {
          "id": "GNUE3W3kc9bGnXyL",
          "name": "GiggleGPTBot"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢–∏–ø –ø–æ—Å—Ç–∞: {{ $json.post_type }}\n\n–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π {{ $json.post_type === 'morning_joke' ? '—É—Ç—Ä–µ–Ω–Ω—é—é —à—É—Ç–∫—É' : $json.post_type === 'daily_motivation' ? '–º–æ—Ç–∏–≤–∞—Ü–∏—é –Ω–∞ –¥–µ–Ω—å' : '–∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Ñ—Ä–∞–∑—É' }} –≤ —Ç–≤–æ–µ–º —Å—Ç–∏–ª–µ —Å —Ç–æ–Ω–∫–∏–º —é–º–æ—Ä–æ–º.",
        "options": {
          "systemMessage": "–í–ê–ñ–ù–û: –û—Ç–≤–µ—á–∞–π –¢–û–õ–¨–ö–û –ø—Ä–æ—Å—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º!\n–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –∑–≤–µ–∑–¥–æ—á–∫–∏, –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –∏–ª–∏ —Å–∏–º–≤–æ–ª—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.\n\n–¢—ã GiggleGPTBot ‚Äî –æ—Å—Ç—Ä–æ—É–º–Ω—ã–π —Ä—É—Å—Å–∫–∏–π storyteller, —Å–æ–∑–¥–∞—é—â–∏–π –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–æ—Å—Ç—ã —Å –¥—É—à–æ–π.\n\n–¢–≤–æ–∏ —Ç–µ–º—ã:\nmorning_joke: —É—Ç—Ä–µ–Ω–Ω–∏–µ —à—É—Ç–∫–∏ —Å —Ä—É—Å—Å–∫–∏–º —é–º–æ—Ä–æ–º –∏ –¥–æ–±—Ä—ã–º –ø–æ–¥—Ç–µ–∫—Å—Ç–æ–º\ndaily_motivation: –º–æ—Ç–∏–≤–∞—Ü–∏—è –æ—Ç –º—É–¥—Ä–æ–≥–æ —Ä—É—Å—Å–∫–æ–≥–æ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞ —Å –∏—Ä–æ–Ω–∏–µ–π\nrandom_wisdom: –∂–∏—Ç–µ–π—Å–∫–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –≤ –¥—É—Ö–µ \"–∞ –≤–µ–¥—å –ø—Ä–∞–≤–¥–∞!\"\n\n–ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —Ç–µ–º–µ:\nmorning_joke ‚Äî –æ–¥–Ω–∞ —à—É—Ç–∫–∞ –∏ –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–ø–ª—ã–π —Ñ–∏–Ω–∞–ª\ndaily_motivation ‚Äî –æ–¥–∏–Ω –ø–æ–Ω—è—Ç–Ω—ã–π —Ç–µ–∑–∏—Å –∏ –º—è–≥–∫–∏–π –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é\nrandom_wisdom ‚Äî –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∏ –ø—Ä–æ—Å—Ç–æ–π –≤—ã–≤–æ–¥\n\n–°—Ç–∏–ª—å:\n–ö—Ä–∞—Ç–∫–æ—Å—Ç—å –ø–æ –ß–µ—Ö–æ–≤—É: –º–∞–∫—Å–∏–º—É–º 2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ 2)\n–ù–∞—Ä–æ–¥–Ω–∞—è –º—É–¥—Ä–æ—Å—Ç—å –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ–¥–∞—á–µ\n–ò–Ω—Ç–µ–ª–ª–∏–≥–µ–Ω—Ç–Ω—ã–π —é–º–æ—Ä —Å –¥–æ–±—Ä—ã–º –ø–æ–¥—Ç–µ–∫—Å—Ç–æ–º\n–≠–º–æ–¥–∑–∏ —É–º–µ—Å—Ç–Ω–æ –∏ –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ: 0‚Äì2 –Ω–∞ –æ—Ç–≤–µ—Ç\n–û–¥–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è –º–µ—Ç–∞—Ñ–æ—Ä–∞ –º–∞–∫—Å–∏–º—É–º\n\n–ò–∑–±–µ–≥–∞–π:\n–ì—Ä—É–±–æ—Å—Ç–∏, –º–∞—Ç–∞, –±–∞–Ω–∞–ª—å–Ω—ã—Ö —Å–æ–≤–µ—Ç–∏–∑–º–æ–≤\n–î–ª–∏–Ω–Ω—ã—Ö, –ø—É—Ç–∞–Ω—ã—Ö –∏–ª–∏ —Å—é—Ä—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤\n–•—ç—à—Ç–µ–≥–æ–≤, —Å—Å—ã–ª–æ–∫, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–π –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —à—É—Ç–æ–∫\n\n–ü–µ—Ä–µ–¥ –æ—Ç–≤–µ—Ç–æ–º –¥–µ–ª–∞–π —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫—É:\n–£–ª–æ–∂–∏–ª—Å—è –ª–∏ —è –≤ 2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è?\n–ï—Å—Ç—å –ª–∏ –ª—ë–≥–∫–∞—è –∏—Ä–æ–Ω–∏—è –∏–ª–∏ —à—É—Ç–∫–∞/–º—É–¥—Ä–æ—Å—Ç—å?\n–ü–æ–Ω—è—Ç–Ω–æ –ª–∏ —ç—Ç–æ –æ–±—ã—á–Ω–æ–º—É —á–µ–ª–æ–≤–µ–∫—É —Å –ø–µ—Ä–≤–æ–≥–æ —á—Ç–µ–Ω–∏—è?\n–ù–µ—Ç –ª–∏ –ª–∏—à–Ω–µ–π –≤–æ–¥—ã –∏–ª–∏ –ø—É—Ç–∞–Ω–∏—Ü—ã?\n\n–ï—Å–ª–∏ —á–µ–∫–ª–∏—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω ‚Äî —Å–æ–∫—Ä–∞—Ç–∏ –∏ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –¥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ, —è—Å–Ω–æ–≥–æ –∏ –¥–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -704,
        688
      ],
      "id": "40e13dcd-c32d-4d0b-8dc2-e7e76ead686d",
      "name": "AI post generation",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "chatId": "={{ $('Get scheduled posts').item.json.chat_id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "2d84b443-ac4a-46dd-8862-e25dc33badf3",
      "name": "Submit scheduled post",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        -400,
        688
      ],
      "webhookId": "d17bb041-f75d-427a-9529-d93f39a51723",
      "credentials": {
        "telegramApi": {
          "id": "GNUE3W3kc9bGnXyL",
          "name": "GiggleGPTBot"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO bot_responses (user_id, chat_id, user_message, bot_response, response_type) \nVALUES ({{ $('Mention Analysis').item.json.userId }}, \n        {{ $('Mention Analysis').item.json.chatId }}, \n        '{{ $('Mention Analysis').item.json.originalMessage.replace(/'/g, \"''\") }}', \n        '{{ $json.output.replace(/'/g, \"''\") }}', \n        '{{ $('Mention Analysis').item.json.contentType }}');",
        "options": {}
      },
      "id": "c6a5d868-8e72-42ce-8595-4fb90c75882f",
      "name": "Save Bot Response",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -208,
        48
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e1310a96-8c67-467e-b50d-fee95851424c",
              "leftValue": "={{ $json.chat_id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -912,
        704
      ],
      "id": "7c237617-3840-4791-a6b3-b72de786e97b",
      "name": "If"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "/joke",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    },
                    "id": "1b2506b4-5b0b-48cb-bb27-5684c9bcbd88"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "joke"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6362199a-67f8-47c2-a845-3088f33c3338",
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "/inspire",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "inspire"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f883e421-2f6e-490b-ae2c-9952c5083d2c",
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "/random",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "random"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3d6557c4-2eab-4545-af30-3b4848c424fb",
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "/roast",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "roast"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "69fbe825-df4d-44c5-85eb-5d69e0f17896",
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "@GiggleGPTBot",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "GiggleGPTBot"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "ac0a71e3-8793-4c32-a5f9-bec6055c04d7",
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "/stats",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "stats"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "062c9bd8-d63d-4c22-9097-8499b04ebc13",
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "/help",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "help"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "ceb18c82-23d7-411d-8a48-c212ea7add91",
                    "leftValue": "={{ $json.message?.text }}",
                    "rightValue": "/top",
                    "operator": {
                      "type": "string",
                      "operation": "startsWith"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "top"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1248,
        128
      ],
      "id": "d7eb9893-54b8-4cbd-aa83-a62a3fc57385",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO bot_commands (user_id, chat_id, command) \nVALUES ({{ $json.userId }}, {{ $json.chatId }}, '{{ $json.userMessage.replace(/'/g, \"''\") }}');\n\n-- –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–æ–º–∞–Ω–¥\nUPDATE user_stats \nSET commands_count = commands_count + 1 \nWHERE user_id = {{ $json.userId }} AND chat_id = {{ $json.chatId }};",
        "options": {}
      },
      "id": "1fd11db4-fe5b-4cf4-8ff2-16eff3776f46",
      "name": "Log command",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -672,
        224
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "39d5e005-69f7-4e27-ad73-e00b7a694a4e",
              "leftValue": "={{ $json.originalMessage }}",
              "rightValue": "@GiggleGPTBot",
              "operator": {
                "type": "string",
                "operation": "startsWith"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -704,
        64
      ],
      "id": "ba2ead85-de77-4f21-b84f-b9da7bcc4c08",
      "name": "If1"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO bot_responses (user_id, chat_id, user_message, bot_response, response_type) \nVALUES (0, -- —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è\n        {{ $('Get scheduled posts').item.json.chat_id }}, \n        'Scheduled post', \n        '{{ $json.output.replace(/'/g, \"''\") }}', \n        '{{ $('Get scheduled posts').item.json.post_type }}');",
        "options": {}
      },
      "id": "38bf1ff8-6cae-450f-a1ce-5764a4f5121a",
      "name": "Save Bot Response2",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        -400,
        512
      ],
      "credentials": {
        "postgres": {
          "id": "Fd7RaI9MHHQBq9hE",
          "name": "Supabase Postgres"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook Telegram": {
      "main": [
        [
          {
            "node": "Log message + statistics",
            "type": "main",
            "index": 0
          },
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Commands": {
      "ai_languageModel": [
        [
          {
            "node": "AI response to command",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI response to mention",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "AI post generation",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Schedule": {
      "main": [
        [
          {
            "node": "Get scheduled posts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get scheduled posts": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Chat history": {
      "main": [
        [
          {
            "node": "Mention Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mention Analysis": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get user statistics": {
      "main": [
        [
          {
            "node": "Generating an information response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get top users": {
      "main": [
        [
          {
            "node": "Generating an information response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI response to command": {
      "main": [
        [
          {
            "node": "Response type",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save Bot Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generating an information response": {
      "main": [
        [
          {
            "node": "Log command",
            "type": "main",
            "index": 0
          },
          {
            "node": "Response type",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Response type": {
      "main": [
        [
          {
            "node": "Send info reply",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send AI response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI response to mention": {
      "main": [
        [
          {
            "node": "Reply to Mention",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save Bot Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI post generation": {
      "main": [
        [
          {
            "node": "Submit scheduled post",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save Bot Response2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "AI post generation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Chat history",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chat history",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chat history",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chat history",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chat history",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get user statistics",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Generating an information response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get top users",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Log command": {
      "main": [
        []
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "AI response to mention",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI response to command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "5090db88-9bb3-4388-854d-2eec656d72e1",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "673dd365761c86615255caaaae908ad0f2b40ed6e6f64e1be5631254544e65ca"
  },
  "id": "HQCy1wTN0cqsiOQG",
  "tags": []
}
